# mangjakseon
제작 기간 : 2022년 6월 14 ~ 2022년 7월 12일

참여 인원 : 6명 (김도겸, 김준희, 권수한, 장재혁, 심동수, 송제운)

# 프로젝트 개요
망한 영화 중에서도 자신이 좋았던 영화를 리뷰 하여
다른 사람에게 추천 할 수 있으며,
화려한 포스터에 속아 내상을 입었다면 이 또한 리뷰를 통해 경고를 줄 수 있음


1. TMDb 영화 데이터 리스트 제공
2. TMDb 기준 6점 이상의 영화는 리뷰 작성 불가
3. 망작선 사이트 자체 리뷰 평점 제공

# 활용 기술
* 개발 환경 : Spring boot, Apache Tomcat, MariaDB
* 개발 언어 : Java, JavaScript, jQuery, Thymeleaf
* 개발 툴 : IntelliJ, HeidiSQL, AWS
* 기타 적용 기술 : JPA, Ajax, Rest API, JSON

# 프로젝트 URL
https://mangjakseon.com


# 개발 중 겪었던 문제와 해결
1. 유효성 검사 메시지 오류
   기존에는 시큐리티의 Failure Handler를 이용하여 서버에서 에러메세지를 view 페이지로
   보내려고 하였으나 망작선 사이트는 로그인 창을 모달을 이용하기 때문에 Failure Handler로 처리할 경우
   페이지가 리로드 되고 URL에 에러메세지가 그대로 담겨서 노출된다는 문제가 있었음.


      해결 - 모달에 어울리도록 ajax를 이용하여 프론트단에서 비동기로 유휴성 검사를 진행하도록 수정


2. 프로필 이미지 한글파일 등록 시 불러오기가 되지 않는 오류
   해당 오류의 원인은 서버에서 UTF-8로 인코딩 되지 않아 발생하는 것이였음


      해결 - img태그에서 src 속성을 한글 파일을 
      강제로 불러오기 하는 방법은 있었으나 권장하지 않는 방식이기에
      JavaScript를 활용하여 한글일 경우 팝업 메시지와 함께 다시 등록하다록 수정 하였음.


3. 별점 기능과 리뷰 쓰기 기능을 통합할 때 겪었던 어려움
   리뷰쓰기와 별점기능을 따로 개발을 했기에 통합시 어려움을 겪음.


      해결 - 리뷰 entity에 별점 컬럼을 추가하고 
      dto,repository, service, controller 도 순차적으로 수정 하였음.


4. 리뷰 작성시 리뷰 데이터가 DB에는 저장 되지만 list를 불러오는 과정에서 오류가 발생
   

      해결 - ReviewController에서 리뷰목록의 MediaType을 APPLICATION_JSON_VALUE를 
      이용하여 JSON형태로 불러오도록 제작


5. 최근에 등록한 리뷰를 가장 윗 부분에 출력하는 Query 작성시 오류 발생


      해결 - Query작성시 내림차순으로 정렬이 되지만 movieId에 해당하는 리뷰만 출력되는 것이 아닌
      모든 리뷰가 출력되는 현상이 나타났었고 
      Query 사용이 미숙하다고 판단되어 method 명명규칙을 사용하여 해결


6. 영화 데이터 API 호출 시 NPE 발생
   영화 데이터 중 해당 영화를 어디서 볼 수 있는지 알 수 있는 데이터가 있음.
   하지만 해당 데이터는 국가별로 데이터가 없을 수도 있고 있을수도 있어 데이터가 없을시 NPE 발생


      해결 - if문으로 null 값을 비교해주면서 null값을 체크 후 데이터 보내줬음
      Optional을 사용하고 싶었지만 이해가 안되는 부분이 있어서 일단 개발 했음.


7. AWS 서버 구축 시 어려웠던 점
   평생 윈도우만 쓰다가 ubuntu를 쓰려니 생소한게 가장 어려웠음.
   war 파일을 wabapps에 넣어줘도 압축은 풀리지만 페이지가 안뜸


      해결 - 로그에 힌트가 있다는걸 많이 느꼈음.
      로그 폴더에 만들어지는 에러 로그를 보며 해결했음
      원인은 윈도우에 설정한 환경변수가 적용이 되지 않아 발생한 오류였고 
      그 부분을 고쳐주니 아주 쉽게 해결이 됐음.

이 밖의 많은 오류와 어려움이 있었지만 이로 인해

로그를 보고 해결하는법, 다른 팀원과 겹치는부분이 있을 시 서로 소통하는법,

그래도 해결 안될땐 질문하는법 등을 배우면서 한단계 성장하는 계기가 됐습니다.

# 진행 상황


# 07.07 beta 배포 완료

bata 배포 후 결함
* ~~로그인 회원가입 회원정보 회원정보 수정 css~~ 
* ~~헤더 따라 내려오기~~ 완료
* ~~무비인포 페이지 포스터 따라 내려오기~~ 
* ~~자신의 리뷰만 수정 삭제 가능하게 해야함~~ 
* ~~영상 게시판 관리자만 쓰도록 수정 해야함~~ 
* ~~6점이상 영화 및 6점 이하 영화 차순 정렬~~
* ~~회원가입 페이지 CSS (사이트 소개 같이 넣기)~~
* ~~리뷰 별점 평균 가져오기 / 리뷰 별점 평균 순위 가져오기~~
* ~~쓸모 없는 로그 및 주석 지우기~~

# 07.08 1차 배포 완료

1차 배포 후 결함
1. ~~회원가입 페이지 css 없음 ( CSS 추가하기 )(상단우측,하단좌측 이미지 골라서 넣어야함)~~
2. ~~구글 로그인시 /home으로 이동함 ( / 로 변경하기)~~
3. ~~걸작선페이지css 변경사항있음 (담당자에게 받은 CSS 적용시키면 됨)~~
4. ~~movie페이지에서 movie-info페이지로 이동 후 뒤로가기로 다시 돌아온 이후에
   평점 6점이상보기, 평점 6점이하보기 작동 안됨 (뒤로가기시 페이징 실행됨이 문제)~~
5. ~~회원정보 수정시 에러 ( 프로필 변경시 파일 변경 문제 )~~
6. ~~회원 프로필 path ubuntu경로로 변경해야함~~
7. ~~리뷰 별점 평균 가져오기 / 리뷰 별점 평균 순위 가져오기 추가해야함~~
8. ~~movie, movieInfo, index에 리뷰 평균 점수별 이모티콘 넣어줘야함~~
9. ~~쓸모 없는 로그 및 주석 지우기~~
10. ~~index에서 사진의 영화제목을 누르면 로컬호스트 주소로 연결됨(웹 주소로 변경해 줘야함)~~
11. ~~제일 메인 페이지 /index 빼기~~


# 07.10 2차 배포 완료

2차 배포 후 결함
1. ~~프로필 수정 페이지 비밀번호 input버튼 길이 (수정 완료)~~
2. 회원 탈퇴 및 프로필 수정 안됨 (윈도우에선 됨)
3. 이미지 경로 설정 안됨 (프로필, 게시판 둘다)
4. ~~회원가입 비밀번호 검증 작동안함~~
5. index, movie, 망작선 점수 및 리스트 간혈적으로 안뜸 

# 금일 일정
이유 없는 오류시 확인하기

* 이유없이 js 가 안먹을때는 jQuery.noConflict(); 이용

* css가 이상이 있으면 해당 옵션에 효과에 !important

-------------------------------------------------
* 리뷰 데이터 넣어주기
* 버그 픽스
* 발표 PPT 작성


# 차후 추가해야할 기능
* 로그인 보안관련 개선
* 미디어 쿼리
* 댓글 기능
* 영화 봤음 버튼
* 리뷰 페이징
* 좋아요 기능
* 검색 인물별 영화별 정렬
* 검색 부분 페이징